<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style>
		@font-face {
			font-family: "originalFont";
			src: url(/0_data/fonts/B612Mono-Regular.ttf) format("truetype");
			src: url(https://u-12031.github.io/0_data/fonts/B612Mono-Regular.ttf) format("truetype");
		}

		@font-face {
			font-family: "numFont";
			src: url(/0_data/fonts/Lekton-Bold.ttf) format("truetype");
			src: url(https://u-12031.github.io/0_data/fonts/Lekton-Bold.ttf) format("truetype");
		}

		* {
			color: white;
			font-family: "originalFont";
		}

		body {
			margin: 0;
			background-color: #010;
		}

		#parent {
			position: relative;
			background-color: #09e;
			display: block;
			width: 400px;
			height: 500px;
			border: none;
			border-radius: 50px;
			overflow: hidden;
		}

		#parent * {
			display: block;
			position: absolute;
		}

		#ground {
			top: 50%;
			left: 50%;
			translate: -50% 0;
			transform-origin: top center;
			background-color: #840;
			width: 1400px;
			height: 100%;
		}

		#high {
			/* background-color: #06c; */
			width: 400px;
			height: 500px;
			clip-path: path("M 0 130 L 25 130 A 200 200 0 0 1 375 130 L 400 130, 400 500, 0 500");
			overflow: hidden;
		}

		#high #highScale {
			top: -450px;
			left: -500px;
			transform-origin: center;
		}

		#bank {
			height: 50%;
			width: 400px;
			top: 0;
			left: 0;
		}

		#test {
			left: 20px;
			top: 20px;
			height: 360px;
			width: 360px;
			clip-path: circle(50% at 50% 50%);
		}

		#bankScale {
			top: 0;
			left: 0;
		}

		#bankTest {
			top: 25px;
			left: 0;
			width: 400px;
			height: 400px;
			border-radius: 100%;
		}

		#bankPointer {
			top: 25px;
			transform-origin: center 200px;
		}
	</style>
</head>
<body>
	<div id="parent">
		<div id="ground"></div>
		<div id="high">
			<canvas id="highScale" width="1400" height="1400"></canvas>
		</div>
		<div id="bank">
			<div id="test"></div>
			<canvas id="bankScale" width="400" height="250"></canvas>
			<canvas id="bankPointer" width="400" height="225"></canvas>
			<div id="bankTest"></div>
		</div>
	</div>
	TEST<br>
	ROTATE<input type="range" id="input1" min="-50" value="0" max="50" style="width: 300px;"><span id="output1">0 deg</span>
	<br>
	X-TRANSFORM<input type="range" id="input2" min="-500" value="0" max="500" style="width: 300px;"><span id="output2">0 px</span>
	<br>
	Y-TRANSFORM<input type="range" id="input3" min="-500" value="0" max="500" style="width: 300px;"><span id="output3">0 px</span>
	<br>

	<script>
		// ここにテスト用のメーターの処理部分があります
		el("input1").oninput = function() {
			el("output1").innerHTML = this.value + " deg";
			el("ground").style.rotate = this.value + "deg";
			el("highScale").style.rotate = this.value + "deg";
			el("bankPointer").style.rotate = this.value + "deg";
			BANK_POINTER.clearRect(0,0, 400,225);
			if(Math.abs(this.value) >= 35) {
				BANK_POINTER.strokeStyle = "#fb1";
				drawLine(BANK_POINTER, [[200,3], [185,23], [215,23]], true, true);
			} else {
				BANK_POINTER.strokeStyle = "white";
				drawLine(BANK_POINTER, [[200,3], [185,23], [215,23]], true, false);
			};
		}
		el("input2").oninput = function() {
			el("output2").innerHTML = this.value + " px";
			el("ground").style.translate = "calc(-50% + " + this.value + "px) " + el("input3").value + "px";
			el("highScale").style.translate = this.value + "px " + el("input3").value + "px";
		}
		el("input3").oninput = function() {
			el("output3").innerHTML = this.value + " px";
			el("ground").style.translate = "calc(-50% + " + el("input2").value + "px) " + this.value + "px";
			el("highScale").style.translate = el("input2").value + "px " + this.value + "px";
		}

		/** この関数は、取得したidを持つ要素を返します。
		 * @param {string} id - 取得する要素のidです。
		*/
		function el(id) {return document.getElementById(id)};
		const HIGH_SCALE = el("highScale").getContext("2d");		
		const BANK_SCALE = el("bankScale").getContext("2d");
		const BANK_POINTER = el("bankPointer").getContext("2d");
		const LINE_WIDTH = 3;

		/** この関数は、要素に線を描画します。
		 * @param {object} objective - 描画先の要素の描画コンテキストです。
		 * @param {array} paths - 描画する線のパスです。[[x1, y1], [x2, y2]]のように配列で入力してください。
		 * @param {boolean} [doClose=false] - 描画した線を閉じるかどうかを定義します。
		 * @param {boolean} [doFill=false] - 描画した線を図形として塗りつぶすがどうかを定義します。これをtrueにするとき、必ずdoCloseもtrueにしてください。
		*/
		function drawLine(objective, paths, doClose=false, doFill=false) {
			const firstPath = paths[0];
			const otherPath = paths.slice(1);
			objective.beginPath();
			objective.moveTo(firstPath[0], firstPath[1]);
			for(const path of otherPath) {
				objective.lineTo(path[0], path[1]);
			};
			if(doClose) objective.closePath();
			objective.stroke();
			if(doFill) objective.fill();
		};
		/** この関数は、要素の中心に線を描画します。
		 * @param {object} objective - 描画先の要素の描画コンテキストです。
		 * @param {number} y - 描画する線の高さです。
		 * @param {number} width - 描画する線の幅です。
		 * @param {boolean} [doClose=true] - 描画した線を閉じるかどうかを定義します。
		*/
		function drawLineOnCenter(objective, y, width, doClose=true) {
			const centerStart = 700 - (width / 2);
			const centerEnd = 700 + (width / 2);
			objective.beginPath();
			objective.moveTo(centerStart, y);
			objective.lineTo(centerEnd, y);
			if(doClose) objective.closePath();
			objective.stroke();
		};
		/** この関数は、特定の円の円周上の点の座標を返します。
		 * @param {array} circleCenter - 円の中心を[x, y]という形式で入力します。
		 * @param {number} radius - 円の半径です。
		 * @param {number} deg - 一般的にθで表される、始線(円の中心からx+方向に伸びる線)から反時計回りに回る角度です。
		*/
		function onCircle(circleCenter, radius, deg) {
			const theta = deg * Math.PI / 180 // degをラジアンに変換

			let result = [,];
			result[0] = circleCenter[0] + radius * Math.cos(theta);
			result[1] = circleCenter[1] - radius * Math.sin(theta);
			
			return result;
		};
		/** この関数は、addScaleOnCenter関数で描画したような目盛りの左右にラベルを付けます。(使われるのは限定的です)
		 * @param {string} [text=""] - 描画するテキストです(英数半角2文字指定。そうでないと正しい位置に表示されません)。
		 * @param {number} y - テキストのy座標です。描画したいところのy座標から10増やした値を入れてください。
		*/
		function addScaleLabel(objective, text="", y) {
			objective.fillText(text, 560, y);
			objective.fillText(text, 820, y);
		};
		HIGH_SCALE.fillStyle = "white";
		HIGH_SCALE.font = "bold 25px 'numFont'"
		HIGH_SCALE.lineWidth = LINE_WIDTH;
		HIGH_SCALE.strokeStyle = "white";

		drawLineOnCenter(HIGH_SCALE, 697.5, 1400);
		
		for(let i=0;i<9;i++) {
			drawLineOnCenter(HIGH_SCALE, -80*i + 677.5, 50);
			drawLineOnCenter(HIGH_SCALE, -80*i + 657.5, 100);
			drawLineOnCenter(HIGH_SCALE, -80*i + 637.5, 50);
			drawLineOnCenter(HIGH_SCALE, -80*i + 617.5, 200);
			addScaleLabel(HIGH_SCALE, `${(i+1)*10}`, -80*i + 627.5);
		};
		for(let i=0;i<9;i++) {
			drawLineOnCenter(HIGH_SCALE, 80*i + 717.5, 50);
			drawLineOnCenter(HIGH_SCALE, 80*i + 737.5, 100);
			drawLineOnCenter(HIGH_SCALE, 80*i + 757.5, 50);
			drawLineOnCenter(HIGH_SCALE, 80*i + 777.5, 200);
			addScaleLabel(HIGH_SCALE, `${(i+1)*10}`, 80*i + 787.5);
		};
		
		BANK_SCALE.fillStyle = "white";
		BANK_SCALE.lineWidth = LINE_WIDTH;
		BANK_SCALE.strokeStyle = "white";

		const MAIN_CIRCLE = [200, 220]; // 基準となる円の中心の座標
		const CIRCLE_RADIUS = [200, 230, 250] // 基準となる2つの円の半径
		drawLine(BANK_SCALE, [[185,0], [215,0], onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 90)], true, true);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 100), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 100)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 110), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 110)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 120), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[2], 120)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 135), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 135)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 150), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 150)]);

		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 80), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 80)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 70), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 70)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 60), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[2], 60)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 45), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 45)]);
		drawLine(BANK_SCALE, [onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[0], 30), onCircle(MAIN_CIRCLE, CIRCLE_RADIUS[1], 30)]);

		BANK_POINTER.fillStyle = "#fb1"
		BANK_POINTER.lineWidth = LINE_WIDTH;
		BANK_POINTER.strokeStyle = "white";

		drawLine(BANK_POINTER, [[200,3], [185,23], [215,23]], true, false);
</script>
</body>
</html>